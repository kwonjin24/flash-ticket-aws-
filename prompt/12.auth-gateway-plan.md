# Gateway 인증/토큰 전담 전환 작업 계획

## 목표
- Gateway가 로그인/회원가입/토큰 발급·재발급까지 담당한다.
- API는 Access 토큰 검증(Guard)만 수행하며 Refresh 엔드포인트는 제거한다.
- 두 서비스는 동일한 JWT 시크릿/설정을 공유하며 `libs` 공용 모듈로 인증 코드를 재사용한다.

## 작업 범위 요약
1. **공용 Auth 라이브러리 구성**
   - `libs/auth` 생성 → DTO, Entity, Service, Facade, Guard, Strategy 등을 이관.
   - 토큰 발급/검증 로직을 서비스 단위로 추출하고 Access/Refresh 설정을 외부에서 주입.
2. **Gateway 측 구현**
   - Gateway에 `AuthModule` 추가: 로그인, 회원가입, refresh API 제공.
   - Queue 모듈과 Auth 모듈을 조합해 로그인→대기열 입장 흐름 처리.
3. **API 측 정리**
   - 기존 `AuthController`에서 로그인/회원가입/Refresh 제거.
   - Access 토큰 검증 Guard만 유지 (필요 시 `AuthFacade` 최소화).
4. **공통 설정/환경 변수 정리**
   - `JWT_ACCESS_SECRET`, `JWT_REFRESH_SECRET`, 만료값 등을 두 서비스가 공유.
   - 문서(RUNTIME_ENV.md, DEV_DEPLOYMENT.md 등) 업데이트.
5. **프런트 영향도 안내**
   - 로그인/Refresh 호출 대상이 Gateway로 변경되었음을 `prompt` 및 문서에 기록.
   - API 호출은 여전히 기존 도메인을 사용하되 토큰은 Gateway에서 발급된 값을 사용.
6. **테스트 & 검증**
   - Gateway: 로그인/Refresh/대기열 입장 E2E 확인.
   - API: 보호된 엔드포인트가 Gateway 발급 토큰으로 접근 가능한지 확인.
