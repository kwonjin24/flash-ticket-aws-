# 03 Load Test ë¹„êµ ë¶„ì„ - Gateway ìŠ¤ì¼€ì¼ë§ ì „í›„

## í…ŒìŠ¤íŠ¸ í™˜ê²½

### ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (15:44)
- **Gateway Pods**: 2ê°œ
- **ë™ì‹œ ì‚¬ìš©ì**: 1,000ëª…
- **Ramp-up**: 120ì´ˆ
- **Event ID**: 5fc5e855-f1e6-4c0a-a758-5f76eb6aee4e

### ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (16:31) - ì¬ì‹œë„
- **Gateway Pods**: 3ê°œ (ì„¤ì • 4ê°œ, ì‹¤ì œ 3ê°œ Running)
- **ë™ì‹œ ì‚¬ìš©ì**: 1,000ëª…
- **Ramp-up**: 120ì´ˆ
- **Event ID**: 5fc5e855-f1e6-4c0a-a758-5f76eb6aee4e (ë™ì¼)

## ì „ì²´ ê²°ê³¼ ë¹„êµ

| ì§€í‘œ | ì²« ë²ˆì§¸ (2 pods) | ë‘ ë²ˆì§¸ (3 pods) | ë³€í™” |
|------|------------------|------------------|------|
| **ì´ ìš”ì²­** | 18,000ê°œ | 18,000ê°œ | - |
| **í…ŒìŠ¤íŠ¸ ì‹œê°„** | 2ë¶„ 21ì´ˆ | 2ë¶„ 39ì´ˆ | +18ì´ˆ (â†“) |
| **ì²˜ë¦¬ëŸ‰** | 127.9 req/s | 112.9 req/s | -11.7% (â†“) |
| **í‰ê·  ì‘ë‹µì‹œê°„** | 898ms | 2,171ms | +141.8% (â†“) |
| **ì—ëŸ¬ìœ¨** | 61.73% | 71.81% | +10.08% (â†“) |
| **ì„±ê³µ ì‚¬ìš©ì** | 521ëª… | 482ëª… | -7.5% (â†“) |

## âš ï¸ ì£¼ìš” ë°œê²¬: ì„±ëŠ¥ ì•…í™”

Gateway Podë¥¼ ëŠ˜ë ¸ìŒì—ë„ **ëª¨ë“  ì§€í‘œê°€ ì•…í™”**ë˜ì—ˆìŠµë‹ˆë‹¤!

### ë‹¨ê³„ë³„ ì„±ê³µë¥  ë¹„êµ

| ë‹¨ê³„ | ì²« ë²ˆì§¸ | ë‘ ë²ˆì§¸ | ë³€í™” |
|------|---------|---------|------|
| 1. Login | 521 (52.1%) | 482 (48.2%) | -7.5% |
| 2. Enqueue | 407 (40.7%) | 313 (31.3%) | -23.1% |
| Queue Status | 2,601 (26.0%) | 1,223 (12.2%) | **-53.0%** |
| 4. Enter Queue | 276 (27.6%) | 129 (12.9%) | **-53.3%** |
| 5. Get Event Detail | 1,000 (100%) | 1,000 (100%) | - |
| ì „ì²´ ì™„ë£Œ | 521 (52.1%) | 482 (48.2%) | -7.5% |

## ì—ëŸ¬ ë¶„ì„

### Queue Status Check ì—ëŸ¬ ë¹„êµ

**ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸:**
```
503 Service Unavailable: 4,383ê°œ (59.2%)
404 Not Found: 2,367ê°œ (32.0%)
504 Gateway Timeout: 331ê°œ
502 Bad Gateway: 312ê°œ
SocketTimeout: 6ê°œ
ì´ ì‹¤íŒ¨: 7,399ê°œ
```

**ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸:**
```
503 Service Unavailable: 5,620ê°œ (64.0%) â†‘ +28.2%
404 Not Found: 2,349ê°œ (26.8%)
SocketTimeout: 372ê°œ â†‘ +6,100%
502 Bad Gateway: 231ê°œ
504 Gateway Timeout: 205ê°œ
ì´ ì‹¤íŒ¨: 8,777ê°œ â†‘ +18.6%
```

### ğŸ”´ ì‹¬ê°í•œ ë¬¸ì œ: Timeout ê¸‰ì¦
- SocketTimeout: 6ê°œ â†’ 372ê°œ (**62ë°° ì¦ê°€**)
- 503 ì—ëŸ¬: 4,383ê°œ â†’ 5,620ê°œ (28% ì¦ê°€)

## ì›ì¸ ë¶„ì„

### 1. GatewayëŠ” ë³‘ëª©ì´ ì•„ë‹˜

Gateway Podë¥¼ 50% ì¦ê°€ì‹œì¼°ì§€ë§Œ:
- âŒ ì„±ëŠ¥ ê°œì„  ì—†ìŒ
- âŒ ì˜¤íˆë ¤ ì•…í™”

**ê²°ë¡ **: GatewayëŠ” ì£¼ìš” ë³‘ëª©ì ì´ **ì•„ë‹™ë‹ˆë‹¤**.

### 2. ì‹¤ì œ ë³‘ëª©ì 

#### ğŸ”´ Queue Service (ìµœìš°ì„  ë³‘ëª©)
```
Queue Status Check ì‹¤íŒ¨ìœ¨:
- ì²« ë²ˆì§¸: 74.0%
- ë‘ ë²ˆì§¸: 87.8% â†‘

503 ì—ëŸ¬ ì¦ê°€ â†’ ì„œë¹„ìŠ¤ ì²˜ë¦¬ ìš©ëŸ‰ í•œê³„
```

#### ğŸ”´ Backend Service (API)
```
Enqueue ì„±ê³µë¥ :
- ì²« ë²ˆì§¸: 40.7%
- ë‘ ë²ˆì§¸: 31.3% â†“

ëŒ€ê¸°ì—´ ì§„ì… ìì²´ê°€ ì‹¤íŒ¨í•˜ê³  ìˆìŒ
```

#### ğŸ”´ Database/Redis ë³‘ëª© ê°€ëŠ¥ì„±
```
SocketTimeout 62ë°° ì¦ê°€:
- DB Connection Pool ê³ ê°ˆ
- Redis ì‘ë‹µ ì§€ì—°
- Network I/O í¬í™”
```

### 3. ì—°ì‡„ ì‹¤íŒ¨ íŒ¨í„´

```
Gateway (ì¦ê°€) â†’ ë” ë§ì€ ìš”ì²­ â†’ Backend ê³¼ë¶€í•˜ ì‹¬í™”
    â†“
Backend ì²˜ë¦¬ ë¶ˆê°€ â†’ ì‘ë‹µ ì§€ì—°
    â†“
Connection Timeout â†’ 503 ê¸‰ì¦
    â†“
ì„±ëŠ¥ ì•…í™”
```

## ì‹œê°„ëŒ€ë³„ ì„±ëŠ¥ ë³€í™”

### ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸
```
ì´ˆê¸° 38ì´ˆ:  ì—ëŸ¬ìœ¨ 23.24%
ì¤‘ë°˜ 30ì´ˆ:  ì—ëŸ¬ìœ¨ 81.19% (ìµœì•…)
í›„ë°˜:       ì—ëŸ¬ìœ¨ 48.14%
ë§ˆì§€ë§‰:     ì—ëŸ¬ìœ¨ 0%
```

### ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸
```
ì´ˆê¸° 24ì´ˆ:  ì—ëŸ¬ìœ¨ 0%
ì¤‘ë°˜ 30ì´ˆ:  ì—ëŸ¬ìœ¨ 83.18% (ë” ì•…í™”)
í›„ë°˜:       ì—ëŸ¬ìœ¨ 78.46% (ì§€ì†)
ë§ˆì§€ë§‰:     ì—ëŸ¬ìœ¨ 66.58% (ì—¬ì „íˆ ë†’ìŒ)
```

**ë¶„ì„**:
- ì´ˆê¸°ëŠ” ì •ìƒ ì‘ë™
- ë¶€í•˜ê°€ ìŒ“ì´ë©´ì„œ ê¸‰ê²©íˆ ì•…í™”
- **ë³µêµ¬ë˜ì§€ ì•Šê³  ì—ëŸ¬ ì§€ì†** (ì²« ë²ˆì§¸ëŠ” 0%ë¡œ ë³µêµ¬, ë‘ ë²ˆì§¸ëŠ” 66% ìœ ì§€)

## í•µì‹¬ ë¬¸ì œ

### âŒ ì˜ëª»ëœ ê°€ì •
"Gateway Podë¥¼ ëŠ˜ë¦¬ë©´ ì „ì²´ ì„±ëŠ¥ì´ ê°œì„ ë  ê²ƒì´ë‹¤"

### âœ… ì‹¤ì œ ìƒí™©
1. **Queue Serviceê°€ ì£¼ìš” ë³‘ëª©**
   - Redis ì²˜ë¦¬ ìš©ëŸ‰ ë¶€ì¡±
   - DB Connection Pool ë¶€ì¡±
   - Service Instance ë¶€ì¡±

2. **Gatewayë¥¼ ëŠ˜ë¦¬ë©´ ì˜¤íˆë ¤ ì•…í™”**
   - ë” ë§ì€ ìš”ì²­ì´ Backendë¡œ ì „ë‹¬
   - Backendê°€ ì²˜ë¦¬ ëª»í•¨
   - Timeoutê³¼ 503 ì¦ê°€

3. **ì „ì²´ ì‹œìŠ¤í…œì˜ ê· í˜• í•„ìš”**
   - Gatewayë§Œ ëŠ˜ë¦¬ëŠ” ê²ƒì€ ë¬´ì˜ë¯¸
   - Backend, DB, Redis ëª¨ë‘ í•¨ê»˜ í™•ì¥ í•„ìš”

## ê°œì„  ë°©ì•ˆ

### ğŸ¯ 1ìˆœìœ„: Queue Service í™•ì¥ (í•„ìˆ˜)

```yaml
# Queue Service replica ì¦ê°€
replicas: 2 â†’ 8 (4ë°°)

# Redis í™•ì¥
- Connection Pool ì¦ê°€
- Redis Sentinel/Cluster êµ¬ì„±
- ë©”ëª¨ë¦¬ ì¦ê°€

# Service Resources ì¦ê°€
resources:
  requests:
    memory: 256Mi â†’ 512Mi
    cpu: 200m â†’ 500m
  limits:
    memory: 512Mi â†’ 1Gi
    cpu: 400m â†’ 1000m
```

### ğŸ¯ 2ìˆœìœ„: API Service í™•ì¥

```yaml
# API Service
replicas: 2 â†’ 6 (3ë°°)

# Database
- Connection Pool ì¦ê°€
- Read Replica ì¶”ê°€
- Query ìµœì í™”
```

### ğŸ¯ 3ìˆœìœ„: ë„¤íŠ¸ì›Œí¬/ì¸í”„ë¼

```yaml
# Timeout ì„¤ì • ì¦ê°€
- Service Timeout: 30s â†’ 60s
- DB Connection Timeout ì¦ê°€
- Redis Timeout ì¦ê°€

# Connection Limit ì¦ê°€
- nginx worker_connections
- Service maxConnections
```

### ğŸ¯ 4ìˆœìœ„: Rate Limiting

```yaml
# Gatewayì— Rate Limiting ì¶”ê°€
- ì‚¬ìš©ìë‹¹ ì´ˆë‹¹ 10 req ì œí•œ
- Backend ë³´í˜¸
- Graceful Degradation
```

## ë¹„êµ ê·¸ë˜í”„

### ì—ëŸ¬ìœ¨ ë³€í™”
```
ì²« ë²ˆì§¸ (2 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 61.73%
ë‘ ë²ˆì§¸ (3 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 71.81%
```

### ì„±ê³µ ì‚¬ìš©ì
```
ì²« ë²ˆì§¸ (2 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 521ëª…
ë‘ ë²ˆì§¸ (3 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 482ëª…
```

### í‰ê·  ì‘ë‹µì‹œê°„
```
ì²« ë²ˆì§¸ (2 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 898ms
ë‘ ë²ˆì§¸ (3 pods): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,171ms
```

## ê²°ë¡ 

### âŒ Gateway ìŠ¤ì¼€ì¼ë§ íš¨ê³¼ ì—†ìŒ
- Gateway Pod 50% ì¦ê°€
- ì„±ëŠ¥ 7.5% ì•…í™”
- ROI: **ë§ˆì´ë„ˆìŠ¤**

### âœ… ì§„ì§œ ë³‘ëª©ì  ë°œê²¬
1. **Queue Service** (ìµœìš°ì„ )
   - 503 ì—ëŸ¬ 5,620ê°œ
   - ëŒ€ê¸°ì—´ ì²´í¬ ì‹¤íŒ¨ìœ¨ 88%

2. **Database/Redis**
   - Timeout 62ë°° ì¦ê°€
   - Connection Pool ê³ ê°ˆ

3. **API Service**
   - Enqueue ì‹¤íŒ¨ìœ¨ 69%

### ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

**ì˜ëª»ëœ ì ‘ê·¼:**
```
Gatewayë§Œ ê³„ì† ëŠ˜ë¦¬ê¸° âŒ
```

**ì˜¬ë°”ë¥¸ ì ‘ê·¼:**
```
1. Queue Service 4ë°° í™•ì¥
2. Redis í´ëŸ¬ìŠ¤í„° êµ¬ì„±
3. API Service 3ë°° í™•ì¥
4. DB Connection Pool ì¦ê°€
5. ê·¸ ë‹¤ìŒì— ì¬í…ŒìŠ¤íŠ¸
```

## ê¶Œì¥ ì‚¬í•­

### ì¦‰ì‹œ ì¡°ì¹˜ (High Priority)

1. **Queue Service ê¸´ê¸‰ í™•ì¥**
   ```bash
   kubectl scale deployment flash-queue -n flash-ticket --replicas=8
   ```

2. **API Service í™•ì¥**
   ```bash
   kubectl scale deployment flash-api -n flash-ticket --replicas=6
   ```

3. **Redis ëª¨ë‹ˆí„°ë§**
   - Connection ìˆ˜ í™•ì¸
   - Memory ì‚¬ìš©ë¥  í™•ì¸
   - Response Time í™•ì¸

### ì¤‘ê¸° ì¡°ì¹˜ (Medium Priority)

4. **Database ìµœì í™”**
   - Connection Pool í¬ê¸° ì¦ê°€
   - Slow Query ë¶„ì„
   - Index ìµœì í™”

5. **Rate Limiting êµ¬í˜„**
   - Gatewayì— ì†ë„ ì œí•œ
   - ì‚¬ìš©ìë‹¹ 10 req/s

### ì¥ê¸° ì¡°ì¹˜ (Long Term)

6. **ì•„í‚¤í…ì²˜ ê°œì„ **
   - Cache ë ˆì´ì–´ ì¶”ê°€
   - Read/Write ë¶„ë¦¬
   - ë¹„ë™ê¸° ì²˜ë¦¬ ë„ì…

## ìƒì„±ëœ íŒŒì¼

- `results/03-load-test/load-test-20251103-154422.jtl` - ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸
- `results/03-load-test/load-test-retry-20251103-163106.jtl` - ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸
- `results/03-load-test/TEST_SUMMARY.md` - ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸ ìƒì„¸ ë¦¬í¬íŠ¸
- `results/03-load-test/COMPARISON_REPORT.md` - ë³¸ íŒŒì¼
