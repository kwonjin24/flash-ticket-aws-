# 다중 이벤트 주문 허용을 위한 작업 정리

## 목표
- 사용자 한 명이 서로 다른 이벤트는 각각 주문할 수 있도록 허용한다.
- 동일 이벤트 내 중복 주문 제한(사용자별 `maxPerUser`) 로직은 유지한다.
- 게이트 토큰은 “대기열 입장 확인” 용도로만 사용하고 주문/결제에는 관여하지 않는다.

## 백엔드 (API)
1. **OrdersService에서 게이트 토큰 의존 제거**
   - `OrdersService.createOrder`에서 `GateTokenService` 호출(`lockGateTokenForOrder`, `markOrderSuccess`, `releaseLock`) 삭제.
   - 주문 생성 시 `queue` 관련 검증 없이 이벤트/재고/사용자 한도만 체크하도록 변경.
   - DTO, 컨트롤러, 헤더에서 `gateToken`/`X-Gate-Token` 요구 사항 제거.
   - `QueueCoreModule`/`GateTokenService` 등 의존성 정리 (`OrdersModule`, `MonitoringModule`, `GateTokenService` 등).
2. **Queue 라이브러리 정리**
   - `libs/queue`에서 주문 연계를 위해 사용하던 메서드(`lockGateTokenForOrder`, `markOrderSuccess`, `releaseOrderLock`) 제거 또는 미사용 처리.
3. **PaymentsService 조정**
   - 게이트 토큰 관련 의존성 제거.
   - 결제 실패 시 주문 상태를 `FAILED`로 갱신하고, 해당 주문은 사용자 소유로 유지.
   - 재고 계산 시 `FAILED` 주문도 `HOLD`와 동일하게 확보된 수량으로 취급.
   - 사용자가 `FAILED` 주문에서 결제를 재시도하면 상태를 `HOLD`로 되돌린 뒤 새 결제 요청을 생성.

## 게이트웨이
- `/queue/enter`는 입장(READY → USED) 확인 전용 유지. 주문/결제 플로우에 더 이상 관여하지 않음.
- 대기열 상태 저장/프런트 통지도 READY/USED까지만 다룸.

## 프런트엔드
1. **API 호출에서 게이트 토큰 제거**
   - 주문 생성(`POST /orders`) 시 `X-Gate-Token` 헤더, `gateToken` 상태 제거.
   - Payment/Order store에서 `gateToken` 관련 필드를 제거하거나 사용하지 않도록 정리.
2. **Queue 상태 활용**
   - 대기열 READY 상태 알림만 유지. 이후 플로우(주문/결제)는 API 응답 기준으로 처리.

> 비고: 각 이벤트별 per-user 제한은 기존 `OrdersService`의 `maxPerUser` 체크로 커버됨.
